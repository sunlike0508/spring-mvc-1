# 웹 어플리케이션

웹 서버는 정적 리소스 실행하는데 더 특화

WAS는 애플리케이션 코드를 실행하는데 더 특화

물론 was도 정적 리소스 실행가능

## 서블릿

<img width="961" alt="Screenshot 2024-08-25 at 16 52 34" src="https://github.com/user-attachments/assets/ccec52b9-5c88-49ba-9a5f-b431d4f96c36">

톰캣처럼 서블릿을 지원하는 was를 서블릿 컨테이너라고 함

서블릿 컨테이너는 서블릿 객체를 생성, 초기화, 호출, 종료하는 생명주기 관리

서블릿 객체는 싱글톤으로 관리 : **공유 변수 사용 주의**

JSP도 서블릿으로 변환되어서 사용

**동시 요청을 위한 멀티 쓰레드 처리 지원**

## 동시 요청 멀티쓰레드

### 쓰레드

애플리케이션 코드를 하나하나 순차적으로 실행하는 것은 쓰레드

자바 메인 메서드를 처음 실행하면 main이라는 이름의 쓰레드가 실행

쓰레드가 없다면 자바 애플리케이션 실행이 불가능

쓰레디는 한번에 하나의 코드 라인을 수

동시 처리가 필요하다면 쓰레드 추가 생성

#### 요청마다 쓰레드 생성

* 장점

동시 요청을 처리할 수 있다.

리소스가 허용할 때까지 처리가능

하나의 쓰레드가 지연되어도 나머지가 동작 가능.

* 단점

쓰레드 생성 비용이 비싸다. 응답 속도가 늦어짐

컨텍스트 스위칭 비용이 발생한다.

생성에 제한이 없다. 고객 요청이 많으면 CPU, 메모리 임계점을 넘어서 서버가 죽을 수 있다.


### 쓰레드 풀

애플리케이션이 생성되면 쓰레드를 여러 개 미리 생성 해놓음.

요청이 들어올때 생성해둔 쓰레드를 사용. 다 쓰면 반납

미리 생성되어 있기 때문에 쓰레드 생성, 종료 비요이 절약. -> 응답 시간 빨라짐

생성 가능한 쓰레드 최대치가 있기 때문에 많은 요청이 들어와도 기존 요청은 안전하게 처리 가능.

* 실무 팁

WAS의 주요 튜닝 포인트는 최대 쓰레드(max thread) 수이다.

너무 낮게 설정하면 서버는 여유로우나 클라언트의 응답이 늦어진다.

너무 높게 설정하면 서버는 다운...

클라우드면 서버를 일단 늘리고 튜닝 (근데 서버 cpu 사용률을 잘 보자 최소 50% 이상은 써야...)

아니면 튜닝...

* 그러면 쓰레드 풀 적정 숫자는?

로직의 복잡도, cpu, 메모리, IO 리소스 상황에 따라 다름

최대한 운영과 같은 환경을 만들고 성능 테스트 꼭 해보자. (아파치 ab, 제이미터, nGrinder 같은 tool 사용)

## CSR

<img width="890" alt="Screenshot 2024-08-25 at 17 24 09" src="https://github.com/user-attachments/assets/0d799a42-9971-4a53-a211-e57ec1727759">

클라이언트 사이드 랜더링

HTML 결과를 자바스크립트를 사용해 웹 브라우저에서 동적으로 생성해서 적용

주로 동적인 화면에 사용, 웹 환경을 마치 앱처럼 필요한 부분별로 변경할 수 있음

구글지도, Gmail이 이렇게 작동

React, Vue.js

## SSR

서버 사이드 렌더링

서버에서 최종 HTML을 생성해서 클라이언트에 전달

JSP, 타임리프
